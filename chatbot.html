<!DOCTYPE html>
<html>
  <head>
    <title>ChatBot</title>
  </head>
  <body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/dayjs.js">
        dayjs().format('MMMM D');
    </script>
    <script src="https://unpkg.com/supersimpledev@8.6.4/external-library.js">
    </script>
    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">
            function ChatInput({ chatMessages, setChatMessages }) {
             const [inputText, setInputText] =  React.useState("");
              function handleChange(event) {
                setInputText (event.target.value);
              }
              function SendMessage () {
                 setChatMessages ([
                    ...chatMessages,
                    {
                       message: inputText,
                    sender: "user",
                    id: crypto.randomUUID()
                    }
                   ]);

                   setInputText ("");
                  }
              return (
                <>
                  <input 
                    placeholder="Type your message....." 
                    size="50" 
                    onChange={handleChange }
                    value={inputText}
                    /> 
                  <button
                  onClick= {SendMessage}
                  >Send</button>  
                </>
              );
            }
          

            function ChatMessage ({ message, sender })  {
                /* function ChatMessage (props) {
                 const message = props.message;
                 const sender = props.sender;
              */
                // const { message, sender } = props;

               /* if (sender === "bot") {
                  return  (
                    <div>
                      <img src="robot.png" width="30px" />
                  {message}
                </div> 
                  )
                }*/
              return (
                <div>
                  {sender === "bot" && <img src="robot.png" width="30px" />}
                  {message}
                  {sender === "user" && <img src="user.png" width="30px" />}
                </div>
                
              )
            }

            function ChatMessages({ chatMessages }) {
                  // useState returns an array with two items
              // const [chatMessages, setChatMessages]
              
                
                return (
                  <>

                    {chatMessages.map((item) => {
                      return (
                        <ChatMessage 
                          message={item.message}
                          sender={item.sender}
                          key={item.id}
                        />
                      );
                    })}
                  </>
                );
            }
            function App () {
              const array = React.useState([{
                  message: "Hello ChatBot",
                  sender: "user",
                  id: "id1"
                },
                {
                  message: "How can I help you?",
                  sender: "bot",
                  id: "id2"
                },
                {
                  message: "Can you get me today's date?",
                  sender: "user",
                  id: "id3"
                },
                {
                  message: "Today is November 2",
                  sender: "bot",
                  id: "id4"
                }]);
                const [chatMessages, setChatMessages] = array; //order matters in array destructuring
              /*  const chatMessages = array[0]; // chatMessages
                const setChatMessages = array[1]; // setChatMessages
              */
                

              return (
                <>
                  <ChatInput 
                    chatMessages={chatMessages}
                    setChatMessages={setChatMessages}
                  />
                  <ChatMessages
                    chatMessages={chatMessages}
                  />
                </>
              );
            }

      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App />);
    </script>
  </body>
</html>